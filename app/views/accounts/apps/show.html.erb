<% unless @app.integrations.exists? %>
  <p>Go to the
    <%= link_to "integrations page", new_accounts_organization_app_integration_path(current_organization, @app) %>
    to create an integration for this app.
  </p>
<% else %>
  <table>
    <thead>
    <tr>
      <th>Category</th>
      <th>Provider</th>
      <th>Connected</th>
      <th>Actions</th>
    </tr>
    </thead>
    <tbody>

    <% @app.integrations.each do |integration| %>
      <tr>
        <td><%= integration.category.titleize %></td>
        <td><%= integration.provider.titleize %></td>
        <td>âœ…</td>
        <td><%= link_to "Edit", edit_accounts_organization_app_integration_path(current_organization, @app, @version_control_integration) %></td>
      </tr>
    <% end %>
    </tbody>
  </table>
  </div>

  <% if @version_control_integration.active_repo.present? %>
    <h3>Releases</h3>
    <%= form_with(url: create_release_branch_accounts_organization_app_path(current_organization, @app), method: :post) do |form| %>
      <div class="field is-grouped">
        <div class="control">
          <%= form.submit 'Create Random Release Branch', class: "button is-link" %>
        </div>
      </div>
    <% end %>

    <hr/>

    <%= form_with(url: create_pull_request_accounts_organization_app_path(current_organization, @app), method: :post) do |form| %>
      <div class="field">
        <%= form.label :pr_head, "Head of PR -- The branch (or git ref) where your changes are implemented", class: "label" %>
        <div class="control">
          <%= form.text_field :pr_head, class: "input" %>
        </div>
      </div>

      <div class="field is-grouped">
        <div class="control">
          <%= form.submit 'Create Pull Request', class: "button is-link" %>
        </div>
      </div>
    <% end %>
  <% else %>
    Please set the <%= link_to "active repo", edit_accounts_organization_app_integration_path(current_organization, @app, @version_control_integration) %> in your VCS integration.
  <% end %>
<% end %>